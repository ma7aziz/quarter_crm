{% load static %}
<div class="card">
    <div class="card-body">
        <h4 class="card-title mb-4" dir="rtl">الطلبات الواردة </h4>

        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" href="#navtabs-all" role="tab">
                    <span class="d-block d-sm-none"><i class="fas fa-home"></i></span>
                    <span class="d-none d-sm-block">
                        جميع الطلبات

                    </span>
                </a>
            </li>
            <!-- <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#navtabs-new" role="tab">
                    <span class="d-block d-sm-none"><i class="far fa-user"></i></span>
                    <span class="d-none d-sm-block">طلبات جديدة
                        <i class="fas fa-tools "></i>
                    </span>
                </a>
            </li> -->


        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="navtabs-all" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <h4 class="card-title mb-4" dir="rtl">الطلبات الواردة </h4>
                            <button id="" class="d-none btn btn-soft-danger quarterMultiDeleteBtn" type="submit">
                                حذف
                                المختارة
                            </button>
                        </div>
                        <div class="my-2 row">
                            <div class="col-sm-12 col-lg-6 mb-1">

                                <input id="" type="text" class=" table_search form-control " placeholder="الـبـحـث... "
                                    name="s">
                            </div>
                            <div class="col-sm-12 col-lg-6 mb-1">
                                <form action="" id="filter-form">
                                    <select name="status" id="status-list" class="form-control
                                    btn" style="font-size: 16px; font-weight: 600 ; background: #ebebeb ; ">

                                        <option selected disabled>عرض حسب حالة الطلب</option>
                                        <option value=" 0">الكل</option>
                                        {% for v , k in status_choices %}
                                        <option value="{{v}}">{{k}}</option>
                                        {% endfor%}
                                    </select>
                                </form>
                            </div>

                        </div>
                        <div class="table-responsive">
                            <table class="table  table-nowrap mb-0 data-table" dir="rtl">
                                <thead class="table-light">
                                    <tr>
                                        <th class="d-none d-lg-table-cell"><input type="checkbox" name="" id="check_all"
                                                class="form-check-input"></th>
                                        <th>رقم الطلب </th>
                                        <th>أسم العميل</th>
                                        <th class="d-none d-lg-table-cell">تاريخ الطلب </th>

                                        <th class="d-none"></th>

                                        <th class="d-none d-lg-table-cell">البائع</th>
                                        <th>
                                            حالة الطلب
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for req in all_requests %}
                                    {% if  not req.status == 15 %}
                                    <tr>
                                        <td class="d-none d-lg-table-cell">
                                            <div class="form-check font-size-16">
                                                <input type="checkbox" class="form-check-input qua_checkbox "
                                                    id="customCheck2" name="req_id[]" value="{{req.id}}">
                                                <label class="form-check-label" for="customCheck2">&nbsp;</label>
                                            </div>
                                        </td>
                                        <td> <a
                                                href="{% url 'quarter_request_details' req.id %}">{{req.request_number}}</a>
                                        </td>
                                        <td> <a href="{% url 'quarter_request_details' req.id %}">{{req.name}}</a>
                                        </td>
                                        <td class="d-none d-lg-table-cell">
                                            {{req.timestamp.date}}
                                        </td>



                                        <td class="d-none">
                                            {{req.phone}}
                                        </td>
                                        <td class="d-none d-lg-table-cell">
                                            <a href="/profile/{{req.created_by.username}}">{{req.created_by}}</a>
                                        </td>
                                        <td class="">
                                            <a class="btn btn-soft-primary btn-sm btn-rounded  waves-effect waves-light"
                                                href="{% url 'quarter_request_details' req.id %}">{{req.get_status_display}}
                                            </a>
                                        </td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}
                                    {% for req in all_requests %}
                                    {% if  req.status == 15 %}
                                    <tr>
                                        <td class="d-none d-lg-table-cell">
                                            <div class="form-check font-size-16">
                                                <input type="checkbox" class="form-check-input qua_checkbox "
                                                    id="customCheck2" name="req_id[]" value="{{req.id}}">
                                                <label class="form-check-label" for="customCheck2">&nbsp;</label>
                                            </div>
                                        </td>
                                        <td> <a
                                                href="{% url 'quarter_request_details' req.id %}">{{req.request_number}}</a>
                                        </td>
                                        <td> <a href="{% url 'quarter_request_details' req.id %}">{{req.name}}</a>
                                        </td>
                                        <td class="d-none d-lg-table-cell">
                                            {{req.timestamp.date}}
                                        </td>



                                        <td class="d-none">
                                            {{req.phone}}
                                        </td>
                                        <td class="d-none d-lg-table-cell">
                                            <a href="/profile/{{req.created_by.username}}">{{req.created_by}}</a>
                                        </td>
                                        <td class="">
                                            <a class="btn btn-soft-primary btn-sm btn-rounded  waves-effect waves-light"
                                                href="{% url 'quarter_request_details' req.id %}">{{req.get_status_display}}
                                            </a>
                                        </td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}

                                </tbody>
                            </table>
                        </div>
                        <!-- end table-responsive -->
                    </div>
                </div>
            </div>
            <div class="tab-pane " id="navtabs-new" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <h4 class="card-title mb-4" dir="rtl">طلبات جديدة </h4>
                            <button id="" class="d-none btn btn-soft-danger quarterMultiDeleteBtn" type="submit">
                                حذف
                                المختارة
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-centered table-nowrap mb-0 text-center" dir="rtl">
                                <thead class="table-light">
                                    <tr>
                                        <th></th>
                                        <th>رقم الطلب </th>
                                        <th>أسم العميل</th>
                                        <th>تاريخ الطلب </th>
                                        <th>حالة الطلب</th>
                                        <th>التفاصيل</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    {% for req in new_requests %}
                                    <tr>
                                        <td>
                                            <div class="form-check font-size-16">
                                                <input type="checkbox" class="form-check-input qua_checkbox "
                                                    id="customCheck2" name="req_id[]" value="{{req.id}}">
                                                <label class="form-check-label" for="customCheck2">&nbsp;</label>
                                            </div>
                                        </td>
                                        <td>{{req.request_number}}</td>
                                        <td>{{req.name}}</td>
                                        <td>
                                            {{req.timestamp.date}}
                                        </td>
                                        <td class="text-center">
                                            <span
                                                class="badge rounded-pill bg-danger font-size-14">{{req.get_status_display}}</span>
                                        </td>
                                        <td>

                                            <a class="btn btn-primary btn-sm btn-rounded waves-effect waves-light"
                                                href="{% url 'quarter_request_details' req.id %}">
                                                التفاصيل
                                            </a>

                                        </td>

                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <!-- end table-responsive -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block script %}
<script src="{% static 'libs/jquery/jquery.min.js' %}"></script>

<script>
    $("#status-list").change(function () {
        $("#filter-form").submit()
    })
    $("#check_all").click(function () {
        $('input:checkbox').not(this).prop('checked', this.checked);
        $('.quarterMultiDeleteBtn').toggleClass('d-none')

    });
</script>
{% endblock %}